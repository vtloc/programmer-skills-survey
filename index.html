<!DOCTYPE html>
<html>
  <head>
    <title>Grokking</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <style media="screen">
      .area-group {
        margin-top: 20px;
      }

      .area {
        border: 1px solid white;
        background-color: #6aaff9;
        font-weight: bold;
        text-align: center;
      }

      .area .title {
        margin-top: 10px;
        margin-bottom: 10px;
        color: white;
      }

      .topic {
        border: 1px solid;
        border-radius: 5px;
        background-color: yellow;
        margin: 2px;
        max-width: calc(100% / 3 - 4px);
        min-height: 50px;

        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;

        font-size: 10px;
        color: black;

        cursor: pointer;
      }

      .topic.chosen {
        background-color: #2257ce;
        color: white;
      }

      .body-wrapper {
        margin: 5px;
      }

      .tooltip-inner {
        white-space:pre-wrap;
        max-width: 300px;
      }

      .footer {
        margin-bottom: 20px;
      }

      /*modal*/
      #choose-topic-modal .modal-body .statistic-show-container {
        border-right: 1px solid grey;
      }

      #choose-topic-modal .modal-body .statistic-choice {
        margin-top: 10px;
      }

      #choose-topic-modal .link-footer {
        margin-top: 15px;
      }


    </style>
  </head>

  <body>
    <div class="container">
      <h3>Để trở thành một Software Engineer giỏi cần phải học hỏi những gì?</h3>
      <p>
        Đây là 1 biểu đồ các kiến thức nền tảng (fundamentals) mà một bạn Senior Software Engineer tổng quát ra được, nhằm giúp các bạn định vị tốt hơn những điều các bạn đang có/cần bổ sung.</p>

      <p>Nửa trên là những kiến thức thực tế cần thiết khi đi làm, bao gồm hiểu công nghệ, hiểu quy trình phát triển phần mềm, và kĩ thuật lập trình (clean coding, code refactoring, vv)</p>


      <p>Nửa dưới là những kiến thức gốc/computer science mà các bạn cần nắm. Cần lưu ý là mình muốn nhấn mạnh tầm quan trọng của "Technical Framework of Thinking", hay 1 cách khác là tư duy problem solving, tư duy system design. Tư duy này là khả năng kết nối những kiến thức lẻ độc lập (lego blocks) mà các bạn học được bên dưới với nhau để đưa ra hướng giải quyết vấn đề.</p>

      <p>
        <a href="https://engineering.grokking.org/ki-su-phan-mem-software-engineer-gioi-thi-phai-nhu-the-nao/">More</a>
      </p>

      <h3>Vậy bạn đã nắm vững bao nhiêu mảng kiến thức trong sơ đồ dưới đây?</h3>
    </div>

    <div class="container vote-container">
      <div class="row area-group">
        <div class="col-sm-4 area" id="area-1"></div>
        <div class="col-sm-4 area" id="area-2"> </div>
        <div class="col-sm-4 area" id="area-3"> </div>
      </div>

      <div class="row area-group">
        <div class="col-sm-12 area" id="area-4"> </div>
      </div>

      <div class="row area-group">
        <div class="col-sm-6 area" id="area-5"> </div>
        <div class="col-sm-6 area" id="area-6"> </div>
      </div>
    </div>

    <div class="footer">

    </div>

    <!-- Modal -->
    <div class="modal fade" id="choose-topic-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Góp ý</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="container">
              <div class="row question">
              Bạn đã nắm vững về  <span class="topic-name"></span>  đến đâu?
              </div>
              <div class="row">
                <div class="col-sm-12 statistic-choice">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="radio" name="statistic-choice" id="statistic-choice-0" value="level 0" checked>
                      Chưa biết về kỹ năng này
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="radio" name="statistic-choice" id="statistic-choice-1" value="level 1">
                      Đã biết về nó, nhưng chưa dùng bao giờ
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="radio" name="statistic-choice" id="statistic-choice-2" value="level 2">
                      Đã làm qua, nhưng chưa thành thạo
                    </label>
                  </div>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="form-check-input" type="radio" name="statistic-choice" id="statistic-choice-3" value="level 3">
                      I grokked this
                    </label>
                  </div>
                </div>
              </div>

              <div class="row link-footer">
                <div class="col-xl-12">
                  Để nâng cao kiến thức về mảng này, bạn có thể tham khảo: <a href="#" target="_blank">Link</a>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Submit</button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <script type="text/javascript">
      var $modal = $("#choose-topic-modal");

      // Render area
      var renderArea = function(areaId, data, dataIndex) {
        topicData = data["topics"];

        var area = d3.select(".vote-container")
                      .select(".area#" + areaId)
                      .append("div").attr("class", "title").text(data["name"])
                      .append("div").attr("class", "body-wrapper row")
                      .selectAll(".topic")
                      .data(topicData);

            area.enter().append("div")
                        .attr("class", "topic col-sm-4")
                        .attr("topic-index", function(d, i) {   // use this index to pour data to statistic modal
                          return dataIndex + '-' + i;
                        })
                        .attr("title", function(d,i) {
                          // show statistic's text
                          var t = "<b>Kết quả tham khảo từ cộng đồng</b>\n\n";
                          t += "Chưa biết về kỹ năng này: " + d.statistic.level_0 + " người\n";
                          t += "Đã biết về nó, nhưng chưa dùng bao giờ: " + d.statistic.level_1 + " người\n";
                          t += "Đã làm qua, nhưng chưa thành thạo: " + d.statistic.level_2 + " người\n";
                          t += "I grokked this: " + d.statistic.level_3 + " người\n";

                          return t;
                        })   
                        .text(function(d) { return d.name; });
      }

      // render Topic
      var addTopicsClickEvent = function() {

        $(".topic").on('click', function() {
          // open statistic modal
          $modal.modal("show", this);

          // highlight
          $(this).addClass('chosen');
        });

        $(".topic").on('mouseenter', function() {
          $(this).tooltip('show');
        });

         $(".topic").on('mouseleave', function() {
          // $(this).tooltip('hide');
        });
      }

      // Fetch areas from api
      var xhr = $.get('http://private-a54a7-semap.apiary-mock.com/map', function(d, status, xhr) {
        // Render areas
        window.data = d["areas"];
        $.each(window.data, function(index, areaData) {
          renderArea(areaData["id"], areaData, index);
        });

        addTopicsClickEvent();
      })
      .fail(function(a, b, c) {
        alert("error");
      })

      // Display modal
      var renderModal = function(areaData, topicData) {
        // render title
        // $modal.find(".modal-title").html(areaData["name"] + " > " + topicData["name"]);
        $modal.find(".question").text("Bạn đã nắm vững về " + topicData["name"] + " đến đâu?");
        $modal.find("a").attr("href", topicData["link"]);

        // render statistic data
        // statisticData = topicData["statistic"];
        // statisticDataSection = $modal.find(".statistic-show-container .statistic-show-data")
        // statisticDataSection.find("span[skill-level=0]").html(statisticData['level_0']);
        // statisticDataSection.find("span[skill-level=1]").html(statisticData['level_1']);
        // statisticDataSection.find("span[skill-level=2]").html(statisticData['level_2']);
        // statisticDataSection.find("span[skill-level=3]").html(statisticData['level_3']);

        // render statistic choice
      };

      $modal.on('show.bs.modal', function(e) {
        var [areaIndex, topicIndex] = $(e.relatedTarget).attr("topic-index").split('-');
        areaData = window.data[areaIndex];
        topicData = data[areaIndex]["topics"][topicIndex];
        renderModal(areaData, topicData);
      });

      // $(".topic[topic-index=0-0]").trigger("click");
    </script>

  </body>
</html>
